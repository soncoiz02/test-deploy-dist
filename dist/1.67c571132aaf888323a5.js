(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{vuL2:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var o=r("dZpG"),i=r("ey9i"),n=r("LvDl"),c=r("wd/R"),s=r("TlHU"),a=r("CcnG"),u=r("7dP1"),d=r("qc5V"),p=r("A7o+"),_=function(e,t,r,o){return new(r||(r=Promise))(function(i,n){function c(e){try{a(o.next(e))}catch(e){n(e)}}function s(e){try{a(o.throw(e))}catch(e){n(e)}}function a(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(c,s)}a((o=o.apply(e,t||[])).next())})},f=function(e,t){var r,o,i,n,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){c.label=n[1];break}if(6===n[0]&&c.label<i[1]){c.label=i[1],i=n;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(n);break}i[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}},l=function(){function e(e,t,r){var o=this;this.authService=e,this.apiService=t,this.translate=r,this.typeDeal=[],this._language=this.authService.getLanguage(),this._translate=this.authService.getTranslate(),r.use(this._language),this.typeDeal=i.g._typeRecords(this._translate),this.typeDeal.map(function(e){return e.checked=!1}),this.typeDeal.map(function(e){1===e.code&&(e.checked=!0,o.codeRecordTypeChecked=e.code)})}return e.prototype.getAll=function(){return this.apiService.get("/records")},e.prototype.getRecord=function(){return this.apiService.get("/records")},e.prototype.getListRecords=function(e){var t,r="includes[]=get_title_name",o=i.b.getExportSchedule(this._translate).schedule;if(["id","name","record_type_code","sign_at","sign_type","send_at","string_code","record_number","status","created_at","submitted_person_name","sign_status","reason","is_record_ivan","is_export","is_gddt"].forEach(function(e){return r+="&fields[]="+e}),(e.is_gddt||0===e.is_gddt)&&(r+="&filter_groups[0][filters][0][key]=is_gddt\n&filter_groups[0][filters][0][value]="+e.is_gddt+"\n&filter_groups[0][filters][0][operator]=eq"),!e.year||e.month&&"TAT_CA"!=e.month||(r+="&filter_groups[0][filters][1][key]=created_at\n&filter_groups[0][filters][1][value][0]="+e.year+"-01-01 00:00:00\n&filter_groups[0][filters][1][value][1]="+e.year+"-12-31 23:59:59\n&filter_groups[0][filters][1][operator]=bt"),e.month&&"TAT_CA"!==e.month){switch(e.month){case"01":t=o.filter(function(e){return"THANG_1"==e.code})[0];break;case"02":(t=o.filter(function(e){return"THANG_2"==e.code})[0]).startDate="YYYY-02-01 00:00:00",t.endDate=e.year%4==0?"YYYY-02-29 23:59:59":"YYYY-02-28 23:59:59";break;case"03":t=o.filter(function(e){return"THANG_3"==e.code})[0];break;case"04":t=o.filter(function(e){return"THANG_4"==e.code})[0];break;case"05":t=o.filter(function(e){return"THANG_5"==e.code})[0];break;case"06":t=o.filter(function(e){return"THANG_6"==e.code})[0];break;case"07":t=o.filter(function(e){return"THANG_7"==e.code})[0];break;case"08":t=o.filter(function(e){return"THANG_8"==e.code})[0];break;case"09":t=o.filter(function(e){return"THANG_9"==e.code})[0];break;case"10":t=o.filter(function(e){return"THANG_10"==e.code})[0];break;case"11":t=o.filter(function(e){return"THANG_11"==e.code})[0];break;case"12":t=o.filter(function(e){return"THANG_12"==e.code})[0]}t.startDate=e.year+t.startDate.substring(4),t.endDate=e.year+t.endDate.substring(4),r+="&filter_groups[0][filters][1][key]=created_at\n&filter_groups[0][filters][1][value][0]="+t.startDate+"\n&filter_groups[0][filters][1][value][1]="+t.endDate+"\n&filter_groups[0][filters][1][operator]=bt"}return e.record_type_code&&"TAT_CA"!==e.record_type_code&&(r+="&filter_groups[0][filters][2][key]=record_type_code\n&filter_groups[0][filters][2][value]="+e.record_type_code+"\n&filter_groups[0][filters][2][operator]=eq"),e.status&&"TAT_CA"!==e.status&&(r+="&filter_groups[0][filters][3][key]=status\n&filter_groups[0][filters][3][value]="+e.status+"\n&filter_groups[0][filters][3][operator]=eq"),this.apiService.getDataTable("/records",r,"&sort[0][key]=created_at&sort[0][direction]=DESC")},e.prototype.getListRecodsTypeResolver=function(e){var t=this.authService.configs;if(e){var r=[];return r=t?[this.apiService.get("/record-types?includes[]=record_type_forms"),this.apiService.get("/record-type-form-fields"),this.apiService.get("/listtypes?"+i.j.fields.listtype)]:[this.apiService.get("/record-types?includes[]=record_type_forms"),this.apiService.get("/record-type-form-fields"),this.apiService.get("/listtypes?"+i.j.fields.listtype),this.apiService.get("/configs")],Object(o.a)(r)}return r=[],r=t?[this.apiService.get("/listtypes?"+i.j.fields.listtype)]:[this.apiService.get("/listtypes?"+i.j.fields.listtype),this.apiService.get("/configs")],Object(o.a)(r)},e.prototype.getListTypes=function(){var e=[this.apiService.get("/listtypes?"+i.j.fields.listtype)];return Object(o.a)(e)},e.prototype.getListRecodsTypePromise=function(e){var t=this,r=[this.apiService.get("/record-types?includes[]=record_type_forms").toPromise(),this.apiService.get("/record-type-form-fields").toPromise()];return Promise.all(r).then(function(r){if(i.c.hideloading(),"success"===r[0].status){var o={record_type:r[0].data.record_types,record_form_filed:r[1].data.record_type_form_fields,updated_at:c().format("YYYY-MM-DD HH:mm:ss")};return localStorage.setItem("data_records",JSON.stringify(o)),null!=e?t.fillRecordType(r[0].data.record_types,e):r[0].data.record_types}return[]}).catch(function(e){return i.c.hideloading(),i.c.notify(e,"error"),[]})},e.prototype.getResolver=function(e,t){var r=[];return r.push(this.apiService.get("/get-time-server")),t&&r.push(this.apiService.get("/records/"+t)),r},e.prototype.getDataToModelRecordsType=function(e,t){return _(this,void 0,void 0,function(){var r,o,c,s,a,u;return f(this,function(d){switch(d.label){case 0:return r=e?0:1,o=[],s=i.a.getRecordType(),n.isEmpty(s)?[4,this.getListRecodsTypePromise(r)]:[3,2];case 1:return c=d.sent(),[3,3];case 2:c=this.fillRecordType(s.record_type,r),d.label=3;case 3:return c?(c=c.filter(function(e){return i.d._attemptConvertBool(e.status)}),a=c.sort(function(e,t){return+e.order<+t.order?-1:1}),u=0,a.forEach(function(e){e.unit_type_list&&e.unit_type_list.split(",").includes(t.default_account.unit_type)&&(e.apply_provinces&&"TAT_CA"!=e.apply_provinces?"TINH_THANH"==e.apply_provinces&&"01"!=t.default_account.province_code?(e.order=++u,o.push(e)):"HA_NOI"==e.apply_provinces&&"01"==t.default_account.province_code&&(e.order=++u,o.push(e)):(e.order=++u,o.push(e)))})):o=[],[2,o]}})})},e.prototype.updateRecord=function(e){return this.apiService.put("/records/"+e)},e.prototype.checkProcess=function(e){return this.apiService.get("/records/check-process/"+e)},e.prototype.getById=function(e){return this.apiService.get("/records/"+e)},e.prototype.showRecords=function(e){return this.apiService.get("/records/show-record/"+e)},e.prototype.add=function(e){return this.apiService.post("/records",e)},e.prototype.edit=function(e,t){return _(this,void 0,void 0,function(){var r=this;return f(this,function(o){return t?[2,this.apiService.put("/records/"+t,e).toPromise().then(function(e){return _(r,void 0,void 0,function(){return f(this,function(t){return[2,e]})})})]:[2,this.apiService.post("/records",e).toPromise().then(function(e){return _(r,void 0,void 0,function(){return f(this,function(t){return[2,e]})})})]})})},e.prototype.getDot=function(e){return _(this,void 0,void 0,function(){var t=this;return f(this,function(r){return[2,this.apiService.post("/record-batchs",{record_id:e}).toPromise().then(function(e){return _(t,void 0,void 0,function(){return f(this,function(t){return[2,e]})})})]})})},e.prototype.getListDot=function(e){return _(this,void 0,void 0,function(){var t=this;return f(this,function(r){return[2,this.apiService.post("/record-batchs/list",{record_type_code:e}).toPromise().then(function(e){return _(t,void 0,void 0,function(){return f(this,function(t){return[2,e]})})})]})})},e.prototype.updateBatchs=function(e,t){return _(this,void 0,void 0,function(){var r=this;return f(this,function(o){return[2,this.apiService.put("/record-batchs/"+t,e).toPromise().then(function(e){return _(r,void 0,void 0,function(){return f(this,function(t){return[2,e]})})})]})})},e.prototype.update=function(e){return this.apiService.post("/records/update",e)},e.prototype.addRecordFile=function(e){return this.apiService.post("/record-files",e)},e.prototype.addAttachFile=function(e){return this.apiService.post("/record-attach-files",e)},e.prototype.sendRecord=function(e,t){return this.apiService.post("/records/send-record/"+t,e)},e.prototype.viewToKhai=function(e){return this.apiService.post("/records/convert-xml",e)},e.prototype.getContenFile=function(e){return this.apiService.get("/getcontent-fileserver?file_id="+e)},e.prototype.deleteRecord=function(e){return this.apiService.delete("/records/"+e)},e.prototype.deleteAttach=function(e){return this.apiService.delete("/record-attach-files/"+e)},e.prototype.getFileTemp=function(e){return this.apiService.post("/records/export_template",e)},e.prototype.createFile=function(e){return this.apiService.post("/records/create-auto-generate-file",e).toPromise()},e.prototype.fillRecordType=function(e,t){return Array.isArray(e)&&e.length>0?(null==t?e:e.filter(function(e){return i.d._attemptConvertBool(e.is_gddt)==i.d._attemptConvertBool(t)})).sort(function(e,t){return e.code-t.code}):[]},e.prototype.formatDate=function(e){return e?c(e,"YYYY-MM-DD HH:mm Z").format("DD/MM/YYYY"):""},e.prototype.formatTimeCreate=function(e){return e?c(e,"YYYY-MM-DD HH:mm:ss").format("HH:mm"):""},e.prototype.formatTime=function(e){return e?c(e,"YYYY-MM-DD HH:mm Z").format("HH:mm"):""},e._createData=function(e,t,r,o,n){var c={record:{}};e.objRecord.id&&(c.record=e.objRecord),c.record.data_version=null,c.record.user_id=t.user.id,c.record.record_type_code=r.code_type,c.record.string_code=r.code_type,c.record.name=r.name,c.record.submitted_person_name=e.objRecord.submitted_person_name,c.record.contact_mobile=e.objRecord.contact_mobile,c.record.month=e.objRecord.month,c.record.year=e.objRecord.year,c.record.sign_status="",c.record.process_time=r.process_time,c.record.procedure_code=r.procedure_code,c.record.procedure_code_iso=r.procedure_code_iso,c.record.is_gddt=r.is_gddt,c.record.pgnhs_code=r.pgnhs_code,c.record.status="101",c.record.note="";var a=s.a.checkTrinhKy(t);c.record.sign_status=a?"CHO_GUI_KY":"",c.record.sign_type=a?"PHAI_TRINH_KY":"KY_VA_NOP",o?(c.record.is_wait_sync="1",c.record.is_export=!0):c.record.is_export=!1,c.record.record_forms=[];var u="";return e.tabs.forEach(function(t){if(0!=t.id){var s="";if(u="",t.code.replace("-","_"),e[t.code]){var a=e[t.code];if(a&&a.gridDataSource){var d=a.gridDataSource.filter(function(e){return e.ho_va_ten&&!i.f._checkTieuDe(e)}),p=i.h.groupBy(d,function(e){return[e.id_staff]});u="H\u1ed3 s\u01a1 g\u1ed3m "+p.length+" ng\u01b0\u1eddi: \n\n";for(var _=[],f=0;f<p.length;f++){var l=p[f];if(3==f){_.push({ho_va_ten:"..."});break}_.push(l[0])}u+=_.map(function(e){return e.ho_va_ten}).join("\n")}else a&&a.dataForm&&a.dataForm.ho_va_ten&&(u="H\u1ed3 s\u01a1 g\u1ed3m 1 ng\u01b0\u1eddi: \n\n",u+=a.dataForm.ho_va_ten);a&&a.additional&&a.additional.hasOwnProperty("ma_doi_tuong")&&(c.record.object_code=a.additional.ma_doi_tuong?a.additional.ma_doi_tuong:null);var h=JSON.parse(JSON.stringify(e[t.code]));delete h.allColumn,delete h.keyColumns,s=JSON.stringify(h)}var y=r.record_type_forms.filter(function(e){return e.code==t.code})[0],g={};1==o&&n&&n.length>0&&(g=n.filter(function(e){return e.code==t.code})[0]);var m={code:t.code,name:t.name,file_size:g&&g.content?g.content.length:0,file_name:g?g.file_name:"",number_record:y.number,is_requirements:y.is_requirements,declaration_form_code:y.declaration_form_code,is_json:y.is_json,json_data:s,data_version:y.data_version,is_auto_generate:null,auto_generate:null,order:t.id,title_name:u,record_file:{file_content:g?g.content:""}};y.code!=i.j.recordTypeForm.DSDN||i.d._attemptConvertBool(r.is_gddt)||(m.name="Danh s\xe1ch \u0111\u1ec1 ngh\u1ecb"),y.auto_generate&&e[i.j.recordTypeForm.Pgnhs]&&e[i.j.recordTypeForm.Pgnhs].dataPGNHS&&e[i.j.recordTypeForm.Pgnhs].dataPGNHS.lstdDocTypeDetail&&(e[i.j.recordTypeForm.Pgnhs].dataPGNHS.lstdDocTypeDetail.filter(function(e){return e.code==y.auto_generate})[0].Select&&(m.is_auto_generate=!0),m.auto_generate=y.auto_generate),c.record.record_forms.push(m)}}),c},e.ghiTam=function(e,t,r,o,n,c){return _(this,void 0,void 0,function(){var n,c,s,a;return f(this,function(u){switch(u.label){case 0:return i.c.showloading(),n=this._createData(e,t,o,!1),[4,r.edit(n,e.objRecord.id)];case 1:return(c=u.sent()).status==i.j.statusApi.success&&(e.isChange=!1,e.objRecord.id?(s=e.objRecord.id,a=e.objRecord.created_at,e.objRecord=n.record,e.objRecord.id=s,e.objRecord.created_at=a):(e.objRecord.id=c.data.id,e.objRecord.created_at=c.data.created_at)),i.c.hideloading(),[2,c]}})})},e._showToolBarMove=function(e){switch(e.code){case i.j.recordTypeForm.DSDN:case i.j.recordTypeForm.D03_TS:case i.j.recordTypeForm.D03_TS_TANG:case i.j.recordTypeForm.D03_TS_GIAM:return!0;default:return!1}},e._showAdditional=function(e,t){return!!(this._showDoiTuongThamGia(e,t)||this._showTyLeDong(e,t)||this._showPPTinh(t,e.code)||this._showMucChuanNgheo(e,t)||this._showGuiKemHSG(t,e))},e._showDoiTuongThamGia=function(e,t){switch(e.code){case i.j.recordTypeForm.D03_TS:case i.j.recordTypeForm.D03_TS_TANG:case i.j.recordTypeForm.D03_TS_GIAM:return t.code_type!=i.j.thu_tuc._603_2;default:return!1}},e._showGuiKemHSG=function(e,t){switch(t.code){case i.j.recordTypeForm.OmDau:case i.j.recordTypeForm.ThaiSan:case i.j.recordTypeForm.DuongSuc:case i.j.recordTypeForm.DieuChinh:return!0;default:return!1}},e._showTyLeDong=function(e,t){switch(e.code){case i.j.recordTypeForm.D03_TS:case i.j.recordTypeForm.D03_TS_TANG:case i.j.recordTypeForm.D03_TS_GIAM:return t.code_type!=i.j.thu_tuc._603_2;default:return!1}},e._showPPTinh=function(e,t){return(e.code_type==i.j.thu_tuc._603_4||e.code_type==i.j.thu_tuc._606a||e.code_type==i.j.thu_tuc._606b)&&t==i.j.recordTypeForm.D03_TS},e._showTotalSoSo=function(e,t){switch(e.code){case i.j.recordTypeForm.DSDN:case i.j.recordTypeForm.D05_TS:return t.code_type==i.j.thu_tuc._607||t.code_type==i.j.thu_tuc._602||t.code_type==i.j.thu_tuc._608;case i.j.recordTypeForm.D02_LT_TANG:return!0;default:return!1}},e._showTotalSoTheBhyt=function(e,t){switch(e.code){case i.j.recordTypeForm.D02_LT_TANG:case i.j.recordTypeForm.D03_TS:case i.j.recordTypeForm.D03_TS_TANG:return!0;case i.j.recordTypeForm.DSDN:return t.code_type!=i.j.thu_tuc._607&&t.code_type!=i.j.thu_tuc._608&&t.code_type!=i.j.thu_tuc._602a&&t.code_type!=i.j.thu_tuc._600o;default:return!1}},e._showTotal=function(e,t){switch(e.code){case i.j.recordTypeForm.DSDN:return t.code_type==i.j.thu_tuc._602a;default:return!1}},e._showMucChuanNgheo=function(e,t){return e.code==i.j.recordTypeForm.D05_TS||t.code_type==i.j.thu_tuc._602a},e._showDot=function(e){return e.code_type==i.j.thu_tuc._630||e.code_type==i.j.thu_tuc._630a||e.code_type==i.j.thu_tuc._630b||e.code_type==i.j.thu_tuc._630c},e.prototype.baocaoC17TS=function(e){return this.apiService.post("/export/c17-ts",e)},e.prototype.convertImageToPdf=function(e){return this.apiService.post("/convert-image-to-pdf",e).toPromise()},e.prototype.getStaffByIds=function(e){return this.apiService.post("/staffs/getlist-byids",e).toPromise()},e.ngInjectableDef=a.X({factory:function(){return new e(a.Ba(u.a),a.Ba(d.a),a.Ba(p.j))},token:e,providedIn:"root"}),e}()}}]);